import yaml,os
class Exploit:

    def loadConfig(self):
        try:
            with open(os.path.join(self.path,"config.yml")) as f:
                data = yaml.load(f, Loader=yaml.FullLoader)
                self.config = data
            return self.config
        except:
            self.config=None
            print("Config File Not Found")
    
    def saveToFile(self):
        with open(os.path.join(self.path, 'config.yml'), 'w') as f:
                yaml.dump(self.config, f)
    
    def setNetwork(self, URL, blockNumber=0):
        self.config['networks']['url'] = URL
        if (blockNumber!=0):
            self.config['networks']['blockNumber'] = blockNumber
        self.saveToFile()
        print("Set url to "+ URL)
        
    def setParameter(self, key, element, value):
        try:
            self.loadConfig()
            self.config[key.lower()][element] = value
            self.saveToFile()
        except:
            print("Key, Element, or Value is not correct")
    
    def showParameters(self):
        self.loadConfig()
        print('--------')
        print('Address:')
        if self.config['address'] is not None:
            for key, value in self.config['address'].items():
                print(key, "-->", value)
        print('--------')
        print('Parameters:')
        if self.config['parameters'] is not None:
            for key, value in self.config['parameters'].items():
                print(key, "-->", value)
        print('--------')
        print('Networks:')
        if self.config['networks'] is not None:
            for key, value in self.config['networks'].items():
                print(key, "-->", value)
        print('--------')

    def init(self, name, path):
        self.name = name
        self.path = path
        self.loadConfig()

    def __init__(self):
        self.name = None
        self.path = None
        self.config = None

global exploit
exploit = Exploit()